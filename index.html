<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Géolocalisation sur le plan de l'hôpital</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <h1>Localisation sur le plan de l'hôpital</h1>
    <div id="map-container">
        <!-- L'image du plan -->
        <img id="map" src="plan_hopital.jpg" alt="Plan de l'hôpital">
        <!-- Marqueur de la position de l'utilisateur -->
        <div id="user-location" class="user-location"></div>
    </div>
    <!-- Nouveau bouton de localisation -->
    <button id="location-btn">Se localiser</button>

    <script>
       // script.js

// Fonction pour obtenir la position de l'utilisateur
function getLocation() {
    if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(showPosition, showError, {
            enableHighAccuracy: true, // Demander des résultats plus précis
            timeout: 10000, // Temps d'attente maximum (en ms)
            maximumAge: 0 // Ne pas utiliser une position mise en cache
        });
    } else {
        alert("La géolocalisation n'est pas supportée par votre navigateur.");
    }
}

// Fonction pour afficher la position de l'utilisateur sur le plan
function showPosition(position) {
    // Définir les bornes géographiques du plan de l'hôpital
    let longitude_min = 1.459878;   // Longitude minimale (exemple)
    let longitude_max = 1.460393;   // Longitude maximale (exemple)
    let latitude_min = 43.628014;   // Latitude minimale (exemple)
    let latitude_max = 43.627748;   // Latitude maximale (exemple)

    // Coordonnées GPS de l'utilisateur
    let longitude = position.coords.longitude;
    let latitude = position.coords.latitude;

    // Vérification des coordonnées GPS de l'utilisateur
    console.log("Coordonnées utilisateur:", longitude, latitude);

    // Vérification si les coordonnées sont dans la zone
    if (longitude >= longitude_min && longitude <= longitude_max && latitude >= latitude_min && latitude <= latitude_max) {
        // Calcul des pourcentages pour la longitude et la latitude
        let longitude_percentage = (longitude - longitude_min) / (longitude_max - longitude_min) * 100;
        let latitude_percentage = (latitude_max - latitude) / (latitude_max - latitude_min) * 100;

        // Récupérer l'élément du marqueur de l'utilisateur
        let userLocation = document.getElementById("user-location");

        // Appliquer les pourcentages calculés pour positionner le marqueur
        userLocation.style.left = longitude_percentage + "%";  // Position horizontale
        userLocation.style.top = latitude_percentage + "%";    // Position verticale
        userLocation.style.display = "block";  // Afficher le marqueur
    } else {
        alert("Les coordonnées GPS de l'utilisateur ne sont pas dans la zone définie.");
    }
}

// Fonction pour gérer les erreurs de géolocalisation
function showError(error) {
    switch (error.code) {
        case error.PERMISSION_DENIED:
            alert("Vous devez autoriser la localisation pour utiliser cette fonctionnalité.");
            break;
        case error.POSITION_UNAVAILABLE:
            alert("La localisation est indisponible.");
            break;
        case error.TIMEOUT:
            alert("La demande de localisation a expiré.");
            break;
        default:
            alert("Une erreur inconnue est survenue.");
    }
}

// Attacher l'événement au bouton de localisation
document.getElementById("location-btn").addEventListener("click", getLocation);


    </script>
</body>
</html>
